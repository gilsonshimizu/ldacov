<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>ldacov - A new LDA formulation with covariates</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">ldacov - A new LDA formulation with covariates</h1>



<style>
body {
text-align: justify}
</style>
<p>ldacov (<span class="citation">Shimizu, Izbicki, and Valle (2020)</span>) is an R package that estimates an LDA model with covariates using MCMC algorithms. The model implemented in this package uses the number of elements in each cluster as the response variable. The logarithmic link function allows an easy interpretation of the regression coefficients that link covariates to the response.</p>
<div id="installation" class="section level2">
<h2>Installation</h2>
<p>Use the devtools package to install ldacov directly from github.</p>
<pre><code>install_github(&quot;gilsonshimizu/ldacov&quot;)</code></pre>
<p>The package can then be loaded using</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">library</span>(ldacov)</span></code></pre></div>
</div>
<div id="datasets" class="section level2">
<h2>Datasets</h2>
<p>To run an LDA model with covariates, we need a counting matrix <span class="math inline">\(y\)</span> with dimension <span class="math inline">\(l\times s\)</span> (<span class="math inline">\(l\)</span> is the number of experimental units, and <span class="math inline">\(s\)</span> the number of categories). In text analysis, for instance, <span class="math inline">\(y\)</span> is the bag-of-words matrix, where <span class="math inline">\(l\)</span> is the number of text documents and <span class="math inline">\(s\)</span> is the number of tokens (words).</p>
<p>We also need an matrix <span class="math inline">\(X\)</span> of dimension <span class="math inline">\(l \times d\)</span> with the values for each of the <span class="math inline">\(d\)</span> covariates for each experimental unit.</p>
<p>Here we use a simulated dataset which contains both matrices <span class="math inline">\(y\)</span> and <span class="math inline">\(X\)</span>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">data</span>(<span class="st">&quot;sim_data&quot;</span>)</span></code></pre></div>
</div>
<div id="optimal-number-of-clusters" class="section level2">
<h2>Optimal number of clusters</h2>
<p>We start by finding the optimal number of clusters. Although this quantity could be chosen <em>a priori</em>, here we use an LDA model without covariates that uses the TSB (truncated stick-breaking) prior (<span class="citation">Albuquerque, Valle, and Li (2019)</span>). This model is implemented using the function <code>gibbs.LDA</code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>lda_no_covariates=<span class="kw">gibbs.LDA</span>(<span class="dt">y=</span>sim_data<span class="op">$</span>y,</span>
<span id="cb4-2"><a href="#cb4-2"></a>                            <span class="dt">ncomm=</span><span class="dv">10</span>,</span>
<span id="cb4-3"><a href="#cb4-3"></a>                            <span class="dt">ngibbs=</span><span class="dv">1000</span>,</span>
<span id="cb4-4"><a href="#cb4-4"></a>                            <span class="dt">nburn=</span><span class="dv">500</span>,</span>
<span id="cb4-5"><a href="#cb4-5"></a>                            <span class="dt">psi=</span><span class="fl">0.01</span>,</span>
<span id="cb4-6"><a href="#cb4-6"></a>                            <span class="dt">gamma=</span><span class="fl">0.1</span>)</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>array.lsk.init=lda_no_covariates<span class="op">$</span>array.lsk</span>
<span id="cb5-2"><a href="#cb5-2"></a>nlk=<span class="kw">apply</span>(array.lsk.init,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),sum)</span>
<span id="cb5-3"><a href="#cb5-3"></a>theta=nlk<span class="op">/</span><span class="kw">apply</span>(nlk,<span class="dv">1</span>,sum)</span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="kw">plot</span>(<span class="kw">cumsum</span>(<span class="kw">colSums</span>(theta,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)<span class="op">/</span><span class="kw">nrow</span>(sim_data<span class="op">$</span>y)),<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,</span>
<span id="cb5-5"><a href="#cb5-5"></a>     <span class="dt">xlab=</span><span class="st">&quot;Number of clusters&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;% of elements&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>On this dataset, 4 clusters contain more than 99% of the elements. Thus, we choose to use 4 clusters in the following analysis.</p>
</div>
<div id="estimation" class="section level2">
<h2>Estimation</h2>
<p>Once the number of clusters has been defined, the estimation of the parameters of ldacov are made through the function <code>gibbs.LDA.cov</code>. This function generates a chain of the parameters <span class="math inline">\(\Phi\)</span> and <span class="math inline">\(\Theta\)</span>, as well as the regression coefficients. If <code>estimate.phi=FALSE</code> then <span class="math inline">\(\Phi\)</span> will not be estimated and the matrix containing the posterior sample (<code>phi.init</code>) of the model without covariates will be used. If <code>estimate.phi=TRUE</code> <span class="math inline">\(\Phi\)</span> will be estimated and the matrix containing the posterior sample (<code>phi.init</code>) of the model without covariates will be used only to initialize the model.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a></span>
<span id="cb6-2"><a href="#cb6-2"></a>lda_with_covariates &lt;-<span class="st"> </span><span class="kw">gibbs.LDA.cov</span>(<span class="dt">ncomm=</span><span class="dv">4</span>,</span>
<span id="cb6-3"><a href="#cb6-3"></a>                                     <span class="dt">ngibbs=</span><span class="dv">1000</span>,</span>
<span id="cb6-4"><a href="#cb6-4"></a>                                     <span class="dt">nburn=</span><span class="dv">500</span>,</span>
<span id="cb6-5"><a href="#cb6-5"></a>                                     <span class="dt">y=</span>sim_data<span class="op">$</span>y,</span>
<span id="cb6-6"><a href="#cb6-6"></a>                                     <span class="dt">xmat=</span>sim_data<span class="op">$</span>xmat,</span>
<span id="cb6-7"><a href="#cb6-7"></a>                                     <span class="dt">phi.prior=</span><span class="fl">0.01</span>,</span>
<span id="cb6-8"><a href="#cb6-8"></a>                                     <span class="dt">array.lsk.init=</span>lda_no_covariates<span class="op">$</span>array.lsk,</span>
<span id="cb6-9"><a href="#cb6-9"></a>                                     <span class="dt">var.betas=</span><span class="kw">c</span>(<span class="dv">10</span>,<span class="kw">rep</span>(<span class="dv">10</span>,<span class="kw">ncol</span>(sim_data<span class="op">$</span>xmat)<span class="op">-</span><span class="dv">1</span>)),</span>
<span id="cb6-10"><a href="#cb6-10"></a>                                     <span class="dt">phi.init=</span>lda_no_covariates<span class="op">$</span>phi,</span>
<span id="cb6-11"><a href="#cb6-11"></a>                                     <span class="dt">estimate.phi=</span><span class="ot">FALSE</span>)</span></code></pre></div>
<p>The convergence of the model can be checked using</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">plot</span>(lda_with_covariates<span class="op">$</span>llk,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">xlab=</span><span class="st">&quot;iterations&quot;</span>,<span class="dt">ylab=</span><span class="st">&#39;log-likelihood&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Typically, the main goals of the ldacov model are: (i) to verify which covariates explain the quantities in each cluster, (ii) to understand the category distributions in each cluster (matrix <span class="math inline">\(\Phi\)</span>), (iii) and understand the distribution of the clusters within each experimental unit (matrix <span class="math inline">\(\Theta\)</span>).</p>
<p>We can see the estimated matrices <span class="math inline">\(\Theta\)</span> and <span class="math inline">\(\Phi\)</span> using</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb8-2"><a href="#cb8-2"></a>seq=<span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">500</span>,<span class="dt">to=</span><span class="dv">1000</span>,<span class="dt">by=</span><span class="dv">1</span>)</span>
<span id="cb8-3"><a href="#cb8-3"></a>lda_with_covariates.theta &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">colMeans</span>(lda_with_covariates<span class="op">$</span>nlk[seq,]),<span class="dt">nrow=</span><span class="kw">nrow</span>(sim_data<span class="op">$</span>y),<span class="dt">ncol=</span><span class="dv">4</span>)<span class="op">/</span><span class="kw">rowSums</span>(<span class="kw">matrix</span>(<span class="kw">colMeans</span>(lda_with_covariates<span class="op">$</span>nlk[seq,]),<span class="dt">nrow=</span><span class="kw">nrow</span>(sim_data<span class="op">$</span>y),<span class="dt">ncol=</span><span class="dv">4</span>))</span>
<span id="cb8-4"><a href="#cb8-4"></a></span>
<span id="cb8-5"><a href="#cb8-5"></a>data &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">X=</span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(sim_data<span class="op">$</span>y), <span class="dt">Y=</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)</span>
<span id="cb8-6"><a href="#cb8-6"></a>data<span class="op">$</span>Z &lt;-<span class="st"> </span><span class="kw">as.vector</span>(lda_with_covariates.theta)</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">ggplot</span>(data, <span class="kw">aes</span>(X, Y, <span class="dt">fill=</span> Z)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_tile</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="st">  </span><span class="kw">scale_fill_gradient</span>(<span class="dt">low=</span><span class="st">&quot;green&quot;</span>, <span class="dt">high=</span><span class="st">&quot;darkblue&quot;</span>,<span class="dt">na.value=</span><span class="st">&quot;green&quot;</span>) <span class="op">+</span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Sample units&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Cluster distribution (%)&quot;</span>) <span class="op">+</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot; &quot;</span>)<span class="op">+</span><span class="kw">theme_minimal</span>() <span class="op">+</span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Estimated Theta matrix&quot;</span>) </span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>lda_with_covariates.phi &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">colMeans</span>(lda_with_covariates<span class="op">$</span>phi[seq,]),<span class="dt">nrow=</span><span class="dv">4</span>,<span class="dt">ncol=</span><span class="kw">ncol</span>(sim_data<span class="op">$</span>y))</span>
<span id="cb10-2"><a href="#cb10-2"></a>data &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">X=</span><span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(sim_data<span class="op">$</span>y), <span class="dt">Y=</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)</span>
<span id="cb10-3"><a href="#cb10-3"></a>data<span class="op">$</span>Z &lt;-<span class="st"> </span><span class="kw">as.vector</span>(lda_with_covariates.phi)</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">ggplot</span>(data, <span class="kw">aes</span>(X, Y, <span class="dt">fill=</span> Z)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_tile</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="st">  </span><span class="kw">scale_fill_gradient</span>(<span class="dt">low=</span><span class="st">&quot;green&quot;</span>, <span class="dt">high=</span><span class="st">&quot;darkblue&quot;</span>,<span class="dt">na.value=</span><span class="st">&quot;green&quot;</span>) <span class="op">+</span></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Category distribution (%)&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Cluster&quot;</span>) <span class="op">+</span></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot; &quot;</span>)<span class="op">+</span><span class="kw">theme_minimal</span>()<span class="op">+</span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Estimated Phi matrix&quot;</span>) </span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>In some cases (as for instance in text analysis), it may be useful to know the main cluster categories (or main words for each topic). We define a category to be relevant for a given cluster if it appears at least twice more in this cluster than in any other cluster. This can be done as follows:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>phi=<span class="kw">matrix</span>(<span class="kw">colMeans</span>(lda_with_covariates<span class="op">$</span>phi[seq,]),<span class="dt">nrow=</span><span class="dv">4</span>,<span class="dt">ncol=</span><span class="kw">ncol</span>(sim_data<span class="op">$</span>y))</span>
<span id="cb12-2"><a href="#cb12-2"></a>phi.max=<span class="kw">matrix</span>(<span class="ot">NA</span>,<span class="dt">nrow=</span><span class="dv">4</span>,<span class="dt">ncol=</span><span class="kw">ncol</span>(sim_data<span class="op">$</span>y))</span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){phi.max[i,]=<span class="kw">apply</span>(phi[<span class="op">-</span>i,], <span class="dv">2</span>, max)}</span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="kw">colnames</span>(phi.max)=<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(sim_data<span class="op">$</span>y)</span>
<span id="cb12-5"><a href="#cb12-5"></a>topic_word_max=<span class="kw">apply</span>(phi<span class="op">/</span>phi.max, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="kw">names</span>(<span class="kw">sort</span>(x,<span class="dt">decreasing=</span><span class="ot">TRUE</span>)))</span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="kw">colnames</span>(topic_word_max)=<span class="kw">c</span>(<span class="st">&quot;Cluster 1&quot;</span>,<span class="st">&quot;Cluster 2&quot;</span>,<span class="st">&quot;Cluster 3&quot;</span>,<span class="st">&quot;Cluster 4&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Cluster 1</th>
<th align="left">Cluster 2</th>
<th align="left">Cluster 3</th>
<th align="left">Cluster 4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">75</td>
<td align="left">91</td>
<td align="left">95</td>
<td align="left">64</td>
</tr>
<tr class="even">
<td align="left">25</td>
<td align="left">66</td>
<td align="left">47</td>
<td align="left">96</td>
</tr>
<tr class="odd">
<td align="left">58</td>
<td align="left">77</td>
<td align="left">63</td>
<td align="left">32</td>
</tr>
<tr class="even">
<td align="left">83</td>
<td align="left">1</td>
<td align="left">54</td>
<td align="left">44</td>
</tr>
<tr class="odd">
<td align="left">74</td>
<td align="left">51</td>
<td align="left">43</td>
<td align="left">99</td>
</tr>
<tr class="even">
<td align="left">87</td>
<td align="left">73</td>
<td align="left">78</td>
<td align="left">39</td>
</tr>
<tr class="odd">
<td align="left">70</td>
<td align="left">62</td>
<td align="left">42</td>
<td align="left">8</td>
</tr>
<tr class="even">
<td align="left">84</td>
<td align="left">93</td>
<td align="left">37</td>
<td align="left">19</td>
</tr>
<tr class="odd">
<td align="left">52</td>
<td align="left">65</td>
<td align="left">59</td>
<td align="left">11</td>
</tr>
<tr class="even">
<td align="left">9</td>
<td align="left">98</td>
<td align="left">12</td>
<td align="left">82</td>
</tr>
</tbody>
</table>
<p>The coefficients of the regression can be extracted using</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">library</span>(reshape2)</span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="kw">library</span>(ggridges)</span>
<span id="cb13-3"><a href="#cb13-3"></a></span>
<span id="cb13-4"><a href="#cb13-4"></a>number &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(seq)</span>
<span id="cb13-5"><a href="#cb13-5"></a>aux1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(number,lda_with_covariates<span class="op">$</span>betas[seq,])</span>
<span id="cb13-6"><a href="#cb13-6"></a>aux2 &lt;-<span class="st"> </span><span class="kw">melt</span>(aux1, <span class="dt">id=</span><span class="kw">c</span>(<span class="st">&quot;number&quot;</span>))</span>
<span id="cb13-7"><a href="#cb13-7"></a>aux2<span class="op">$</span>variable &lt;-<span class="st"> </span>(<span class="kw">gsub</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;&quot;</span>, aux2<span class="op">$</span>variable))</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw">ggplot</span>(aux2, <span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> variable, <span class="dt">fill =</span> variable)) <span class="op">+</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="st">  </span><span class="kw">geom_density_ridges</span>(<span class="dt">size=</span><span class="fl">0.4</span>) <span class="op">+</span></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="st">  </span><span class="kw">theme_ridges</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Value&quot;</span>) <span class="op">+</span></span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Betas&quot;</span>) <span class="op">+</span></span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),</span>
<span id="cb14-8"><a href="#cb14-8"></a>        <span class="dt">axis.text.y=</span><span class="kw">element_blank</span>(),</span>
<span id="cb14-9"><a href="#cb14-9"></a>        <span class="dt">axis.ticks.y=</span><span class="kw">element_blank</span>(),</span>
<span id="cb14-10"><a href="#cb14-10"></a>        <span class="dt">axis.title.x=</span><span class="kw">element_blank</span>())</span>
<span id="cb14-11"><a href="#cb14-11"></a><span class="co">#&gt; Picking joint bandwidth of 0.0769</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-albuquerque2019bayesian">
<p>Albuquerque, Pedro HM, Denis Ribeiro do Valle, and Daijiang Li. 2019. “Bayesian Lda for Mixed-Membership Clustering Analysis: The Rlda Package.” <em>Knowledge-Based Systems</em> 163: 988–95.</p>
</div>
<div id="ref-shimizu2020ldacov">
<p>Shimizu, Gilson Yuuji, Rafael Izbicki, and Denis Ribeiro do Valle. 2020. “A New Lda Formulation with Covariates.”</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
