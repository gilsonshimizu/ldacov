<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>ldacov - A new Latent Dirichlet Allocation (LDA) formulation with covariates</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">ldacov - A new Latent Dirichlet Allocation (LDA) formulation with covariates</h1>



<style>
body {
text-align: justify}
</style>
<p>ldacov (<span class="citation">Shimizu, Izbicki, and Valle (2020)</span>) is an R package that estimates the Latent Dirichlet Allocation (LDA) model with covariates using an MCMC algorithm. The model implemented in this package uses the number of elements in each cluster as the response variable. The logarithmic link function used to relate covariates to the response variable allows an easy interpretation of the regression coefficients.</p>
<div id="installation" class="section level2">
<h2>Installation</h2>
<p>Use the devtools package to install ldacov directly from github.</p>
<pre><code>install_github(&quot;gilsonshimizu/ldacov&quot;)</code></pre>
<p>The package can then be loaded using</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">library</span>(ldacov)</span></code></pre></div>
</div>
<div id="datasets" class="section level2">
<h2>Datasets</h2>
<p>To run the LDA model with covariates, we need a counting matrix <span class="math inline">\(y\)</span> with dimension <span class="math inline">\(l\times s\)</span> (<span class="math inline">\(l\)</span> is the number of units, and <span class="math inline">\(s\)</span> the number of categories). In text analysis, for instance, <span class="math inline">\(y\)</span> is the bag-of-words matrix, where <span class="math inline">\(l\)</span> is the number of text documents and <span class="math inline">\(s\)</span> is the number of tokens (words). In Ecology, often <span class="math inline">\(l\)</span> is the number of field plots and <span class="math inline">\(s\)</span> is the number of species. We also need an matrix <span class="math inline">\(X\)</span> of dimension <span class="math inline">\(l \times (d+1)\)</span> with a column of 1’s for the intercept and the values for each of the <span class="math inline">\(d\)</span> covariates. Here we use a simulated data set which contains both matrices <span class="math inline">\(y\)</span> and <span class="math inline">\(X\)</span>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">data</span>(<span class="st">&quot;sim_data&quot;</span>)</span></code></pre></div>
</div>
<div id="optimal-number-of-clusters" class="section level2">
<h2>Optimal number of clusters</h2>
<p>We start by finding the optimal number of clusters. Although this quantity could be chosen <em>a priori</em>, here we use an LDA model without covariates that relies on a truncated stick-breaking (TSB) prior to identify the number of clusters (<span class="citation">Albuquerque, Valle, and Li (2019)</span>). This model is implemented using the function <code>gibbs.LDA</code>. The arguments required for this function are:</p>
<ul>
<li><code>y</code>: counting matrix containing the data (rows are units and columns are categories);</li>
<li><code>ncomm</code>: maximum number of clusters;</li>
<li><code>ngibbs</code>: number of iterations for the Gibbs sampler;</li>
<li><code>nburn</code>: number of iterations to be discarded as burn-in;</li>
<li><code>psi</code>: parameter for the prior Dirichlet distribution used for <span class="math inline">\(\phi_k\)</span> (the vector of probabilities that characterizes each cluster); and</li>
<li><code>gamma</code>: parameter for the TSB prior used for <span class="math inline">\(\theta_l\)</span> (the vector of probabilities that characterizes each unit).</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a>lda_no_covariates=<span class="kw">gibbs.LDA</span>(<span class="dt">y=</span>sim_data<span class="op">$</span>y,</span>
<span id="cb4-3"><a href="#cb4-3"></a>                            <span class="dt">ncomm=</span><span class="dv">10</span>,</span>
<span id="cb4-4"><a href="#cb4-4"></a>                            <span class="dt">ngibbs=</span><span class="dv">1000</span>,</span>
<span id="cb4-5"><a href="#cb4-5"></a>                            <span class="dt">nburn=</span><span class="dv">500</span>,</span>
<span id="cb4-6"><a href="#cb4-6"></a>                            <span class="dt">psi=</span><span class="fl">0.01</span>,</span>
<span id="cb4-7"><a href="#cb4-7"></a>                            <span class="dt">gamma=</span><span class="fl">0.1</span>)</span></code></pre></div>
<p>This function outputs a list which contains the following elements:</p>
<ul>
<li><code>llk</code>: posterior samples for the log-likelihood;<br />
</li>
<li><code>theta</code>: posterior samples for the <span class="math inline">\(\Theta\)</span> matrix containing the proportion of each cluster in each unit;</li>
<li><code>phi</code>: posterior samples for the <span class="math inline">\(\Phi\)</span> matrix containing the proportion of each category within each cluster; and</li>
<li><code>vmat</code>: posterior samples for the <span class="math inline">\(V\)</span> matrix in the stick-breaking formulation, which is then used to derive the <span class="math inline">\(\Theta\)</span> matrix; and</li>
<li><code>array.lsk</code>: the last posterior sample for an array with the number of individuals in each unit, category, and cluster.</li>
</ul>
<p>We first assess convergence by inspecting the trace-plot of the log-likelihood. This plot suggests that the algorithm has converged after discarding the first 500 iterations:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">plot</span>(lda_no_covariates<span class="op">$</span>llk,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">xlab=</span><span class="st">&#39;Iterations&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;Log-likelihood&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>We used <code>array.lsk</code> to determine the optimal number of clusters (<code>theta</code> could have been used as well). On this dataset, the LDA model with the TSB prior seems to have identified 4 main cluster as these clusters contain more than 99% of the elements. Thus, we choose to use 4 clusters for the subsequent analysis.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>array.lsk.init=lda_no_covariates<span class="op">$</span>array.lsk</span>
<span id="cb6-2"><a href="#cb6-2"></a>nlk=<span class="kw">apply</span>(array.lsk.init,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),sum)</span>
<span id="cb6-3"><a href="#cb6-3"></a>theta=nlk<span class="op">/</span><span class="kw">apply</span>(nlk,<span class="dv">1</span>,sum)</span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="kw">colnames</span>(theta)=<span class="kw">paste0</span>(<span class="st">&#39;Cluster&#39;</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)</span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="kw">rownames</span>(theta)=<span class="kw">paste0</span>(<span class="st">&#39;Unit&#39;</span>,<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(sim_data<span class="op">$</span>y))</span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="kw">head</span>(<span class="kw">round</span>(theta,<span class="dv">2</span>))</span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="co">#&gt;       Cluster1 Cluster2 Cluster3 Cluster4 Cluster5 Cluster6 Cluster7 Cluster8</span></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="co">#&gt; Unit1     0.01     0.96     0.03     0.00     0.00        0        0        0</span></span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="co">#&gt; Unit2     0.01     0.00     0.00     0.98     0.01        0        0        0</span></span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="co">#&gt; Unit3     0.01     0.00     0.99     0.00     0.00        0        0        0</span></span>
<span id="cb6-11"><a href="#cb6-11"></a><span class="co">#&gt; Unit4     1.00     0.00     0.00     0.00     0.00        0        0        0</span></span>
<span id="cb6-12"><a href="#cb6-12"></a><span class="co">#&gt; Unit5     0.03     0.97     0.00     0.00     0.00        0        0        0</span></span>
<span id="cb6-13"><a href="#cb6-13"></a><span class="co">#&gt; Unit6     0.00     0.00     0.00     1.00     0.00        0        0        0</span></span>
<span id="cb6-14"><a href="#cb6-14"></a><span class="co">#&gt;       Cluster9 Cluster10</span></span>
<span id="cb6-15"><a href="#cb6-15"></a><span class="co">#&gt; Unit1        0         0</span></span>
<span id="cb6-16"><a href="#cb6-16"></a><span class="co">#&gt; Unit2        0         0</span></span>
<span id="cb6-17"><a href="#cb6-17"></a><span class="co">#&gt; Unit3        0         0</span></span>
<span id="cb6-18"><a href="#cb6-18"></a><span class="co">#&gt; Unit4        0         0</span></span>
<span id="cb6-19"><a href="#cb6-19"></a><span class="co">#&gt; Unit5        0         0</span></span>
<span id="cb6-20"><a href="#cb6-20"></a><span class="co">#&gt; Unit6        0         0</span></span>
<span id="cb6-21"><a href="#cb6-21"></a></span>
<span id="cb6-22"><a href="#cb6-22"></a><span class="kw">boxplot</span>(theta,<span class="dt">ylab=</span><span class="kw">expression</span>(theta),<span class="dt">xlab=</span><span class="st">&#39;Clusters&#39;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a></span>
<span id="cb7-2"><a href="#cb7-2"></a>cumsum1=<span class="kw">cumsum</span>(<span class="kw">colSums</span>(theta,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)<span class="op">/</span><span class="kw">nrow</span>(sim_data<span class="op">$</span>y))</span>
<span id="cb7-3"><a href="#cb7-3"></a>cumsum1[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>]</span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co">#&gt;  Cluster1  Cluster2  Cluster3  Cluster4 </span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="co">#&gt; 0.2808978 0.5194413 0.7637801 0.9953563</span></span></code></pre></div>
</div>
<div id="estimation" class="section level2">
<h2>Estimation</h2>
<p>Once the number of clusters has been defined, the estimation of the parameters of ldacov are made through the function <code>gibbs.LDA.cov</code>. The arguments required by this function are:</p>
<ul>
<li><code>ncomm</code>: number of clusters;</li>
<li><code>ngibbs</code>: number of iterations for the Gibbs sampler;</li>
<li><code>y</code>: counting matrix containing the data (rows are units and columns are categories);</li>
<li><code>xmat</code>: matrix containing covariate information (rows are units and each column contains a different covariate). Notice that the first column of this matrix should be comprised of 1’s if the regression model is to have an intercept;<br />
</li>
<li><code>phi.prior</code>: parameter to be used in the Dirichlet prior for <span class="math inline">\(\Phi\)</span> if this matrix is estimated;</li>
<li><code>array.lsk.init</code>: initial values for the <code>array.lsk</code> array;</li>
<li><code>var.betas</code>: variance parameters for the normal distribution priors for the regression coefficients;</li>
<li><code>phi.init</code>: posterior samples from the <span class="math inline">\(\Phi\)</span> matrix estimated by “gibbs.lda”. If <code>estimate.phi</code> is TRUE, then these posterior samples are used simply to initialize the <span class="math inline">\(\Phi\)</span> matrix. If <code>estimate.phi</code> is FALSE, then these posterior samples are used instead of attempting to re-estimate the <span class="math inline">\(\Phi\)</span> matrix; and</li>
<li><code>estimate.phi</code>: if <span class="math inline">\(\Phi\)</span> matrix is supposed to be estimated (TRUE or FALSE).</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>lda_with_covariates &lt;-<span class="st"> </span><span class="kw">gibbs.LDA.cov</span>(<span class="dt">ncomm=</span><span class="dv">4</span>,</span>
<span id="cb8-2"><a href="#cb8-2"></a>                                     <span class="dt">ngibbs=</span><span class="dv">1000</span>,</span>
<span id="cb8-3"><a href="#cb8-3"></a>                                     <span class="dt">y=</span>sim_data<span class="op">$</span>y,</span>
<span id="cb8-4"><a href="#cb8-4"></a>                                     <span class="dt">xmat=</span>sim_data<span class="op">$</span>xmat,</span>
<span id="cb8-5"><a href="#cb8-5"></a>                                     <span class="dt">phi.prior=</span><span class="fl">0.01</span>,</span>
<span id="cb8-6"><a href="#cb8-6"></a>                                     <span class="dt">array.lsk.init=</span>lda_no_covariates<span class="op">$</span>array.lsk,</span>
<span id="cb8-7"><a href="#cb8-7"></a>                                     <span class="dt">var.betas=</span><span class="kw">rep</span>(<span class="dv">100</span>,<span class="kw">ncol</span>(sim_data<span class="op">$</span>xmat)),</span>
<span id="cb8-8"><a href="#cb8-8"></a>                                     <span class="dt">phi.init=</span>lda_no_covariates<span class="op">$</span>phi,</span>
<span id="cb8-9"><a href="#cb8-9"></a>                                     <span class="dt">estimate.phi=</span><span class="ot">FALSE</span>)</span></code></pre></div>
<p>This function outputs a list which contains the following elements:</p>
<ul>
<li><code>llk</code>: posterior samples for the log-likelihood;<br />
</li>
<li><code>phi</code>: if <code>estimate.phi</code>=TRUE, then this consists of posterior samples for the <span class="math inline">\(\Phi\)</span> matrix containing the proportion of each category within each cluster. If <code>estimate.phi</code>=FALSE, then this just outputs random samples from lda_no_covariates$phi;</li>
<li><code>nlk</code>: posterior samples for the <span class="math inline">\(n_{lk}\)</span> matrix containing the number of elements in each unit <span class="math inline">\(l\)</span> and cluster <span class="math inline">\(k\)</span>;</li>
<li><code>betas</code>: posterior samples for the regression parameters for each cluster <span class="math inline">\(k\)</span>; * <code>fmodel</code>: posterior samples of the log-likelihood plus the log priors; and</li>
<li><code>NBN</code>: posterior samples for the dispersion parameter <span class="math inline">\(N\)</span> from the negative-binomial regression.</li>
</ul>
<p>One way to assess convergence consists of inspecting the trace-plot of the log-likelihood. This plot suggests that the algorithm has converged after discarding the first 100 iterations:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">plot</span>(lda_with_covariates<span class="op">$</span>llk,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">xlab=</span><span class="st">&quot;iterations&quot;</span>,<span class="dt">ylab=</span><span class="st">&#39;log-likelihood&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Typically, the main goals of the ldacov model are:</p>
<ol style="list-style-type: lower-roman">
<li><p>to verify which covariates explain the quantities in each cluster,</p></li>
<li><p>to understand the category distributions in each cluster (matrix <span class="math inline">\(\Phi\)</span>),</p></li>
<li><p>and understand the distribution of the clusters within each unit (matrix <span class="math inline">\(\Theta\)</span>).</p></li>
</ol>
<p>We start by examining <span class="math inline">\(\Theta\)</span>. We obtain the posterior mean for this matrix in the following way:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>seq1=<span class="dv">100</span><span class="op">:</span><span class="dv">1000</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>tmp=<span class="kw">matrix</span>(<span class="kw">colMeans</span>(lda_with_covariates<span class="op">$</span>nlk[seq1,]),<span class="dt">nrow=</span><span class="kw">nrow</span>(sim_data<span class="op">$</span>y),<span class="dt">ncol=</span><span class="dv">4</span>)</span>
<span id="cb10-3"><a href="#cb10-3"></a>theta &lt;-<span class="st"> </span>tmp<span class="op">/</span><span class="kw">rowSums</span>(tmp)</span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="kw">colnames</span>(theta)=<span class="kw">paste0</span>(<span class="st">&#39;Cluster&#39;</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)</span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="kw">rownames</span>(theta)=<span class="kw">paste0</span>(<span class="st">&#39;Units&#39;</span>,<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(sim_data<span class="op">$</span>y))</span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="kw">head</span>(<span class="kw">round</span>(theta,<span class="dv">2</span>))</span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="co">#&gt;        Cluster1 Cluster2 Cluster3 Cluster4</span></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="co">#&gt; Units1     0.01     0.97     0.01     0.01</span></span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="co">#&gt; Units2     0.02     0.00     0.00     0.98</span></span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="co">#&gt; Units3     0.01     0.00     0.98     0.00</span></span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="co">#&gt; Units4     0.99     0.00     0.00     0.00</span></span>
<span id="cb10-12"><a href="#cb10-12"></a><span class="co">#&gt; Units5     0.03     0.95     0.01     0.01</span></span>
<span id="cb10-13"><a href="#cb10-13"></a><span class="co">#&gt; Units6     0.00     0.00     0.00     0.99</span></span></code></pre></div>
<p>We then plot this matrix:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>data &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">X=</span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(sim_data<span class="op">$</span>y), <span class="dt">Y=</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)</span>
<span id="cb11-2"><a href="#cb11-2"></a>data<span class="op">$</span>proportion &lt;-<span class="st"> </span><span class="kw">as.vector</span>(theta)</span>
<span id="cb11-3"><a href="#cb11-3"></a></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="kw">ggplot</span>(data, <span class="kw">aes</span>(X, Y, <span class="dt">fill=</span> proportion)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_tile</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="st">  </span><span class="kw">scale_fill_gradient</span>(<span class="dt">low=</span><span class="st">&quot;green&quot;</span>, <span class="dt">high=</span><span class="st">&quot;darkblue&quot;</span>,<span class="dt">na.value=</span><span class="st">&quot;green&quot;</span>) <span class="op">+</span></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Units&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Cluster distribution&quot;</span>) <span class="op">+</span></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot; &quot;</span>)<span class="op">+</span><span class="kw">theme_minimal</span>() <span class="op">+</span></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Estimated Theta matrix&quot;</span>) </span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Similarly, we can also examine the <span class="math inline">\(\Phi\)</span> matrix. We calculate the posterior mean in the following way:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>phi &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">colMeans</span>(lda_with_covariates<span class="op">$</span>phi[seq1,]),<span class="dt">nrow=</span><span class="dv">4</span>,<span class="dt">ncol=</span><span class="kw">ncol</span>(sim_data<span class="op">$</span>y))</span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="kw">rownames</span>(phi)=<span class="kw">paste0</span>(<span class="st">&#39;Cluster&#39;</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)</span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="kw">colnames</span>(phi)=<span class="kw">paste0</span>(<span class="st">&#39;Category&#39;</span>,<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(sim_data<span class="op">$</span>y))</span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="kw">head</span>(<span class="kw">round</span>(phi[,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>],<span class="dv">2</span>))</span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="co">#&gt;          Category1 Category2 Category3 Category4 Category5 Category6 Category7</span></span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="co">#&gt; Cluster1      0.00      0.00      0.04      0.00      0.04      0.00      0.00</span></span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="co">#&gt; Cluster2      0.04      0.00      0.00      0.00      0.00      0.04      0.00</span></span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="co">#&gt; Cluster3      0.00      0.00      0.00      0.04      0.00      0.00      0.00</span></span>
<span id="cb12-9"><a href="#cb12-9"></a><span class="co">#&gt; Cluster4      0.00      0.03      0.00      0.00      0.00      0.00      0.03</span></span>
<span id="cb12-10"><a href="#cb12-10"></a><span class="co">#&gt;          Category8 Category9 Category10</span></span>
<span id="cb12-11"><a href="#cb12-11"></a><span class="co">#&gt; Cluster1      0.03      0.00       0.00</span></span>
<span id="cb12-12"><a href="#cb12-12"></a><span class="co">#&gt; Cluster2      0.00      0.00       0.00</span></span>
<span id="cb12-13"><a href="#cb12-13"></a><span class="co">#&gt; Cluster3      0.00      0.00       0.00</span></span>
<span id="cb12-14"><a href="#cb12-14"></a><span class="co">#&gt; Cluster4      0.00      0.03       0.03</span></span></code></pre></div>
<p>We can visualize the <span class="math inline">\(\Phi\)</span> matrix using the code below:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>data &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">X=</span><span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(sim_data<span class="op">$</span>y), <span class="dt">Y=</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)</span>
<span id="cb13-2"><a href="#cb13-2"></a>data<span class="op">$</span>proportion &lt;-<span class="st"> </span><span class="kw">as.vector</span>(phi)</span>
<span id="cb13-3"><a href="#cb13-3"></a></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="kw">ggplot</span>(data, <span class="kw">aes</span>(X, Y, <span class="dt">fill=</span> proportion)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_tile</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="st">  </span><span class="kw">scale_fill_gradient</span>(<span class="dt">low=</span><span class="st">&quot;green&quot;</span>, <span class="dt">high=</span><span class="st">&quot;darkblue&quot;</span>,<span class="dt">na.value=</span><span class="st">&quot;green&quot;</span>) <span class="op">+</span></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Category distribution&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Cluster&quot;</span>) <span class="op">+</span></span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot; &quot;</span>)<span class="op">+</span><span class="kw">theme_minimal</span>()<span class="op">+</span></span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Estimated Phi matrix&quot;</span>) </span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>In many situations, it may be useful to identify the main cluster categories (i.e., main words for each topic or the main species in each community). We define a category to be relevant for a given cluster if it appears at least twice more frequently in the focus cluster than in any other cluster. We use the following code to help us in this task:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>phi.max=<span class="kw">matrix</span>(<span class="ot">NA</span>,<span class="dt">nrow=</span><span class="dv">4</span>,<span class="dt">ncol=</span><span class="kw">ncol</span>(sim_data<span class="op">$</span>y))</span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){phi.max[i,]=<span class="kw">apply</span>(phi[<span class="op">-</span>i,], <span class="dv">2</span>, max)}</span>
<span id="cb14-3"><a href="#cb14-3"></a>results=phi<span class="op">/</span>phi.max</span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="kw">colnames</span>(results)=<span class="kw">colnames</span>(phi)</span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="kw">rownames</span>(results)=<span class="kw">rownames</span>(phi)</span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="kw">head</span>(<span class="kw">round</span>(results[,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>],<span class="dv">2</span>))</span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="co">#&gt;          Category1 Category2 Category3 Category4 Category5 Category6 Category7</span></span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="co">#&gt; Cluster1      0.01      0.02  15526.91      0.01   7847.31      0.00      0.02</span></span>
<span id="cb14-9"><a href="#cb14-9"></a><span class="co">#&gt; Cluster2     87.57      0.03      0.00      0.02      0.00   6530.22      0.01</span></span>
<span id="cb14-10"><a href="#cb14-10"></a><span class="co">#&gt; Cluster3      0.00      0.01      0.00     42.69      0.00      0.00      0.02</span></span>
<span id="cb14-11"><a href="#cb14-11"></a><span class="co">#&gt; Cluster4      0.00     35.24      0.00      0.00      0.00      0.00     41.41</span></span>
<span id="cb14-12"><a href="#cb14-12"></a><span class="co">#&gt;          Category8 Category9 Category10</span></span>
<span id="cb14-13"><a href="#cb14-13"></a><span class="co">#&gt; Cluster1  17128.35      0.02       0.03</span></span>
<span id="cb14-14"><a href="#cb14-14"></a><span class="co">#&gt; Cluster2      0.00      0.03       0.02</span></span>
<span id="cb14-15"><a href="#cb14-15"></a><span class="co">#&gt; Cluster3      0.00      0.01       0.02</span></span>
<span id="cb14-16"><a href="#cb14-16"></a><span class="co">#&gt; Cluster4      0.00     37.09      36.31</span></span></code></pre></div>
<p>For example, these results suggest that “Category 1” is 88 times more common in “Cluster 2” than in any other cluster. Similarly, “Category 2” is 35 times more common in “Cluster 4” than in any other cluster. We use the following code to identify the main cluster categories:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>max_categ_cluster=<span class="kw">apply</span>(phi<span class="op">/</span>phi.max, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="kw">names</span>(<span class="kw">sort</span>(x,<span class="dt">decreasing=</span><span class="ot">TRUE</span>)))</span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="kw">head</span>(max_categ_cluster)</span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="co">#&gt;      Cluster1     Cluster2     Cluster3     Cluster4    </span></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="co">#&gt; [1,] &quot;Category32&quot; &quot;Category73&quot; &quot;Category63&quot; &quot;Category83&quot;</span></span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="co">#&gt; [2,] &quot;Category17&quot; &quot;Category6&quot;  &quot;Category46&quot; &quot;Category52&quot;</span></span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="co">#&gt; [3,] &quot;Category44&quot; &quot;Category65&quot; &quot;Category95&quot; &quot;Category58&quot;</span></span>
<span id="cb15-7"><a href="#cb15-7"></a><span class="co">#&gt; [4,] &quot;Category28&quot; &quot;Category27&quot; &quot;Category89&quot; &quot;Category74&quot;</span></span>
<span id="cb15-8"><a href="#cb15-8"></a><span class="co">#&gt; [5,] &quot;Category29&quot; &quot;Category69&quot; &quot;Category54&quot; &quot;Category7&quot; </span></span>
<span id="cb15-9"><a href="#cb15-9"></a><span class="co">#&gt; [6,] &quot;Category64&quot; &quot;Category98&quot; &quot;Category47&quot; &quot;Category76&quot;</span></span></code></pre></div>
<p>Finally, the posterior mean of the regression coefficients are extracted in the following way:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>tmp=<span class="kw">colMeans</span>(lda_with_covariates<span class="op">$</span>betas[seq1,])</span>
<span id="cb16-2"><a href="#cb16-2"></a>betas=<span class="kw">matrix</span>(tmp,<span class="dt">ncol=</span><span class="dv">4</span>)</span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="kw">colnames</span>(betas)=<span class="kw">paste0</span>(<span class="st">&#39;Cluster&#39;</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)</span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="kw">rownames</span>(betas)=<span class="kw">paste0</span>(<span class="st">&#39;Coefficients&#39;</span>,<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(betas))</span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="kw">head</span>(<span class="kw">round</span>(betas,<span class="dv">3</span>))</span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="co">#&gt;               Cluster1 Cluster2 Cluster3 Cluster4</span></span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="co">#&gt; Coefficients1    2.657    2.124    1.815    1.802</span></span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="co">#&gt; Coefficients2   -0.017    0.990    0.039    0.040</span></span>
<span id="cb16-9"><a href="#cb16-9"></a><span class="co">#&gt; Coefficients3    0.069    0.136    0.175    1.242</span></span>
<span id="cb16-10"><a href="#cb16-10"></a><span class="co">#&gt; Coefficients4   -0.031    0.050    1.183    0.049</span></span>
<span id="cb16-11"><a href="#cb16-11"></a><span class="co">#&gt; Coefficients5    0.852   -0.103   -0.109    0.047</span></span></code></pre></div>
<p>We can also examine the posterior distribution of the regression coefficients in the following way:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw">library</span>(reshape2)</span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="kw">library</span>(ggridges)</span>
<span id="cb17-3"><a href="#cb17-3"></a>number &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(seq1)</span>
<span id="cb17-4"><a href="#cb17-4"></a>aux1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(number,lda_with_covariates<span class="op">$</span>betas[seq1,])</span>
<span id="cb17-5"><a href="#cb17-5"></a>aux2 &lt;-<span class="st"> </span><span class="kw">melt</span>(aux1, <span class="dt">id=</span><span class="kw">c</span>(<span class="st">&quot;number&quot;</span>))</span>
<span id="cb17-6"><a href="#cb17-6"></a>aux2<span class="op">$</span>variable &lt;-<span class="st"> </span>(<span class="kw">gsub</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;&quot;</span>, aux2<span class="op">$</span>variable))</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw">ggplot</span>(aux2, <span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> variable, <span class="dt">fill =</span> variable)) <span class="op">+</span></span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="st">  </span><span class="kw">geom_density_ridges</span>(<span class="dt">size=</span><span class="fl">0.4</span>) <span class="op">+</span></span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="st">  </span><span class="kw">theme_ridges</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Value&quot;</span>) <span class="op">+</span></span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Betas&quot;</span>) <span class="op">+</span></span>
<span id="cb18-7"><a href="#cb18-7"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),</span>
<span id="cb18-8"><a href="#cb18-8"></a>        <span class="dt">axis.text.y=</span><span class="kw">element_blank</span>(),</span>
<span id="cb18-9"><a href="#cb18-9"></a>        <span class="dt">axis.ticks.y=</span><span class="kw">element_blank</span>(),</span>
<span id="cb18-10"><a href="#cb18-10"></a>        <span class="dt">axis.title.x=</span><span class="kw">element_blank</span>())</span>
<span id="cb18-11"><a href="#cb18-11"></a><span class="co">#&gt; Picking joint bandwidth of 0.0717</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-albuquerque2019bayesian">
<p>Albuquerque, Pedro HM, Denis Ribeiro do Valle, and Daijiang Li. 2019. “Bayesian Lda for Mixed-Membership Clustering Analysis: The Rlda Package.” <em>Knowledge-Based Systems</em> 163: 988–95.</p>
</div>
<div id="ref-shimizu2020ldacov">
<p>Shimizu, Gilson Yuuji, Rafael Izbicki, and Denis Ribeiro do Valle. 2020. “A New Lda Formulation with Covariates.”</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
